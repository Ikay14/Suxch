{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\DELL\\\\Documents\\\\projects\\\\suxch\\\\chat-client\\\\src\\\\components\\\\Chat\\\\ChatWindow.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport './ChatWindow.css';\nimport MessageList from './MessageList';\nimport MessageInput from './MessageInput';\nimport UploadedFiles from './UploadedFiles';\nimport { FaPaperclip } from 'react-icons/fa';\nimport io from 'socket.io-client';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst SOCKET_SERVER_URL = 'http://localhost:8080/chat'; // Adjust port as needed\n\nconst ChatWindow = () => {\n  _s();\n  const [uploadedFiles, setUploadedFiles] = useState([]);\n  const [socket, setSocket] = useState(null);\n  const [messages, setMessages] = useState([]);\n  const [clientId, setClientId] = useState(null); // New state for client ID\n\n  useEffect(() => {\n    const newSocket = io(SOCKET_SERVER_URL);\n    setSocket(newSocket);\n    newSocket.on('connect', () => {\n      var _newSocket$id;\n      console.log('Connected to server:', newSocket.id);\n      setClientId((_newSocket$id = newSocket.id) !== null && _newSocket$id !== void 0 ? _newSocket$id : null); // Use null if newSocket.id is undefined\n    });\n\n    // Listen for incoming messages\n    newSocket.on('message', message => {\n      setMessages(prevMessages => [...prevMessages, message]);\n    });\n\n    // Listen for user-joined event\n    newSocket.on('user-joined', username => {\n      setMessages(prevMessages => [...prevMessages, {\n        system: true,\n        text: `${username} has joined the chat.`\n      }]);\n    });\n\n    // Handle connection errors\n    newSocket.on('connect_error', error => {\n      console.error('Connection error:', error);\n    });\n\n    // Cleanup on unmount\n    return () => {\n      newSocket.close();\n    };\n  }, []);\n  const handleFileUpload = event => {\n    if (event.target.files && event.target.files[0]) {\n      const file = event.target.files[0];\n      setUploadedFiles(prevFiles => [...prevFiles, file]);\n      if (socket) {\n        const reader = new FileReader();\n        reader.onload = e => {\n          var _e$target;\n          socket.emit('file-upload', {\n            name: file.name,\n            type: file.type,\n            data: (_e$target = e.target) === null || _e$target === void 0 ? void 0 : _e$target.result\n          });\n        };\n        reader.readAsDataURL(file);\n      }\n    }\n  };\n  const handleSendMessage = message => {\n    if (socket) {\n      socket.emit('message', {\n        text: message,\n        userId: 'user123',\n        timestamp: new Date().toISOString()\n      });\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"chat-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"chat-header\",\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        children: \"Chat Room\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 17\n      }, this), clientId && /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [\"Client ID: \", clientId]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 30\n      }, this), \" \"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"chat-content\",\n      children: [/*#__PURE__*/_jsxDEV(MessageList, {\n        messages: messages,\n        currentUserId: \"user123\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(UploadedFiles, {\n        files: uploadedFiles\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"chat-input-area\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"file-upload\",\n          className: \"file-upload-icon\",\n          children: /*#__PURE__*/_jsxDEV(\"span\", {\n            children: /*#__PURE__*/_jsxDEV(FaPaperclip, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 91,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 90,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 89,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          id: \"file-upload\",\n          type: \"file\",\n          style: {\n            display: 'none'\n          },\n          onChange: handleFileUpload\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 94,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(MessageInput, {\n          onSend: handleSendMessage\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 100,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 80,\n    columnNumber: 9\n  }, this);\n};\n_s(ChatWindow, \"W/poDxzn0sxb20SX/lm9t8lJpLU=\");\n_c = ChatWindow;\nexport default ChatWindow;\nvar _c;\n$RefreshReg$(_c, \"ChatWindow\");","map":{"version":3,"names":["React","useState","useEffect","MessageList","MessageInput","UploadedFiles","FaPaperclip","io","jsxDEV","_jsxDEV","SOCKET_SERVER_URL","ChatWindow","_s","uploadedFiles","setUploadedFiles","socket","setSocket","messages","setMessages","clientId","setClientId","newSocket","on","_newSocket$id","console","log","id","message","prevMessages","username","system","text","error","close","handleFileUpload","event","target","files","file","prevFiles","reader","FileReader","onload","e","_e$target","emit","name","type","data","result","readAsDataURL","handleSendMessage","userId","timestamp","Date","toISOString","className","children","fileName","_jsxFileName","lineNumber","columnNumber","currentUserId","htmlFor","style","display","onChange","onSend","_c","$RefreshReg$"],"sources":["C:/Users/DELL/Documents/projects/suxch/chat-client/src/components/Chat/ChatWindow.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport './ChatWindow.css';\nimport MessageList from './MessageList';\nimport MessageInput from './MessageInput';\nimport UploadedFiles from './UploadedFiles';\nimport { FaPaperclip } from 'react-icons/fa';\nimport io, { Socket } from 'socket.io-client';\n\nconst SOCKET_SERVER_URL = 'http://localhost:8080/chat'; // Adjust port as needed\n\nconst ChatWindow: React.FC = () => {\n    const [uploadedFiles, setUploadedFiles] = useState<File[]>([]);\n    const [socket, setSocket] = useState<Socket | null>(null);\n    const [messages, setMessages] = useState<any[]>([]);\n    const [clientId, setClientId] = useState<string | null>(null); // New state for client ID\n\n    useEffect(() => {\n        const newSocket = io(SOCKET_SERVER_URL);\n        setSocket(newSocket);\n\n        newSocket.on('connect', () => {\n            console.log('Connected to server:', newSocket.id);\n            setClientId(newSocket.id ?? null); // Use null if newSocket.id is undefined\n        });\n\n        // Listen for incoming messages\n        newSocket.on('message', (message) => {\n            setMessages((prevMessages) => [...prevMessages, message]);\n        });\n\n        // Listen for user-joined event\n        newSocket.on('user-joined', (username) => {\n            setMessages((prevMessages) => [\n                ...prevMessages,\n                { system: true, text: `${username} has joined the chat.` },\n            ]);\n        });\n\n        // Handle connection errors\n        newSocket.on('connect_error', (error) => {\n            console.error('Connection error:', error);\n        });\n\n        // Cleanup on unmount\n        return () => {\n            newSocket.close();\n        };\n    }, []);\n\n    const handleFileUpload = (event: React.ChangeEvent<HTMLInputElement>) => {\n        if (event.target.files && event.target.files[0]) {\n            const file = event.target.files[0];\n            setUploadedFiles((prevFiles) => [...prevFiles, file]);\n\n            if (socket) {\n                const reader = new FileReader();\n                reader.onload = (e) => {\n                    socket.emit('file-upload', {\n                        name: file.name,\n                        type: file.type,\n                        data: e.target?.result,\n                    });\n                };\n                reader.readAsDataURL(file);\n            }\n        }\n    };\n\n    const handleSendMessage = (message: string) => {\n        if (socket) {\n            socket.emit('message', {\n                text: message,\n                userId: 'user123',\n                timestamp: new Date().toISOString(),\n            });\n        }\n    };\n\n    return (\n        <div className=\"chat-container\">\n            <div className=\"chat-header\">\n                <h1>Chat Room</h1>\n                {clientId && <p>Client ID: {clientId}</p>} {/* Display client ID */}\n            </div>\n            <div className=\"chat-content\">\n                <MessageList messages={messages} currentUserId=\"user123\" />\n                <UploadedFiles files={uploadedFiles} />\n                <div className=\"chat-input-area\">\n                    <label htmlFor=\"file-upload\" className=\"file-upload-icon\">\n                        <span>\n                            <FaPaperclip />\n                        </span>\n                    </label>\n                    <input\n                        id=\"file-upload\"\n                        type=\"file\"\n                        style={{ display: 'none' }}\n                        onChange={handleFileUpload}\n                    />\n                    <MessageInput onSend={handleSendMessage} />\n                </div>\n            </div>\n        </div>\n    );\n};\n\nexport default ChatWindow;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}