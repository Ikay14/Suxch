{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\DELL\\\\Documents\\\\projects\\\\suxch\\\\chat-client\\\\src\\\\components\\\\Chat\\\\ChatWindow.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport './ChatWindow.css';\nimport MessageList from './MessageList';\nimport MessageInput from './MessageInput';\nimport UploadedFiles from './UploadedFiles';\nimport { FaPaperclip } from 'react-icons/fa';\nimport io from 'socket.io-client';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst SOCKET_SERVER_URL = 'http://localhost:8080/chat'; // Adjust port as needed\n\nconst ChatWindow = () => {\n  _s();\n  const [uploadedFiles, setUploadedFiles] = useState([]);\n  const [socket, setSocket] = useState(null);\n  const [messages, setMessages] = useState([]);\n  const [clientId, setClientId] = useState(null);\n\n  // Dynamically retrieve userId and receiverId (replace with actual logic)\n  const [userId] = useState(() => localStorage.getItem('userId') || 'user123'); // Example: from localStorage\n  const [receiverId] = useState(() => localStorage.getItem('receiverId') || 'receiver123'); // Example: from localStorage\n\n  useEffect(() => {\n    const newSocket = io(SOCKET_SERVER_URL, {\n      query: {\n        userId\n      } // Pass userId to the server\n    });\n    setSocket(newSocket);\n    newSocket.on('connect', () => {\n      var _newSocket$id;\n      console.log('Connected to server:', newSocket.id);\n      setClientId((_newSocket$id = newSocket.id) !== null && _newSocket$id !== void 0 ? _newSocket$id : null); // Use null if newSocket.id is undefined\n    });\n\n    // Listen for incoming messages\n    newSocket.on('new_message', message => {\n      setMessages(prevMessages => [...prevMessages, message]);\n    });\n\n    // Listen for user-joined event\n    newSocket.on('user-joined', username => {\n      setMessages(prevMessages => [...prevMessages, {\n        system: true,\n        text: `${username} has joined the chat.`\n      }]);\n    });\n\n    // Listen for file-sent event\n    newSocket.on('file-sent', fileMessage => {\n      setMessages(prevMessages => [...prevMessages, fileMessage]);\n    });\n\n    // Handle connection errors\n    newSocket.on('connect_error', error => {\n      console.error('Connection error:', error);\n    });\n\n    // Cleanup on unmount\n    return () => {\n      newSocket.close();\n    };\n  }, [userId]);\n  const handleFileUpload = event => {\n    if (event.target.files && event.target.files[0]) {\n      const file = event.target.files[0];\n      setUploadedFiles(prevFiles => [...prevFiles, file]);\n      if (socket) {\n        const formData = new FormData();\n        formData.append('file', file);\n        formData.append('senderId', userId);\n        formData.append('receiverId', receiverId);\n        socket.emit('fileUpload', formData, response => {\n          if (response.status === 'success') {\n            console.log('File uploaded successfully:', response.data);\n          } else {\n            console.error('File upload failed:', response.message);\n          }\n        });\n      }\n    }\n  };\n  const handleSendMessage = message => {\n    if (socket) {\n      socket.emit('send_message', {\n        senderId: userId,\n        receiverId,\n        content: message\n      }, response => {\n        if (response.status === 'success') {\n          console.log('Message sent successfully:', response.data);\n        } else {\n          console.error('Message sending failed:', response.message);\n        }\n      });\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"chat-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"chat-header\",\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        children: \"Chat Room\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 17\n      }, this), clientId && /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [\"Client ID: \", clientId]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 30\n      }, this), \" \"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"chat-content\",\n      children: [/*#__PURE__*/_jsxDEV(MessageList, {\n        messages: messages,\n        currentUserId: userId\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(UploadedFiles, {\n        files: uploadedFiles\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"chat-input-area\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"file-upload\",\n          className: \"file-upload-icon\",\n          children: /*#__PURE__*/_jsxDEV(\"span\", {\n            children: /*#__PURE__*/_jsxDEV(FaPaperclip, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 115,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 114,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 113,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          id: \"file-upload\",\n          type: \"file\",\n          style: {\n            display: 'none'\n          },\n          onChange: handleFileUpload\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 118,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(MessageInput, {\n          onSend: handleSendMessage\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 124,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 104,\n    columnNumber: 9\n  }, this);\n};\n_s(ChatWindow, \"4gdbuLOaUxAyV74K+IxKddzm06A=\");\n_c = ChatWindow;\nexport default ChatWindow;\nvar _c;\n$RefreshReg$(_c, \"ChatWindow\");","map":{"version":3,"names":["React","useState","useEffect","MessageList","MessageInput","UploadedFiles","FaPaperclip","io","jsxDEV","_jsxDEV","SOCKET_SERVER_URL","ChatWindow","_s","uploadedFiles","setUploadedFiles","socket","setSocket","messages","setMessages","clientId","setClientId","userId","localStorage","getItem","receiverId","newSocket","query","on","_newSocket$id","console","log","id","message","prevMessages","username","system","text","fileMessage","error","close","handleFileUpload","event","target","files","file","prevFiles","formData","FormData","append","emit","response","status","data","handleSendMessage","senderId","content","className","children","fileName","_jsxFileName","lineNumber","columnNumber","currentUserId","htmlFor","type","style","display","onChange","onSend","_c","$RefreshReg$"],"sources":["C:/Users/DELL/Documents/projects/suxch/chat-client/src/components/Chat/ChatWindow.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport './ChatWindow.css';\nimport MessageList from './MessageList';\nimport MessageInput from './MessageInput';\nimport UploadedFiles from './UploadedFiles';\nimport { FaPaperclip } from 'react-icons/fa';\nimport io, { Socket } from 'socket.io-client';\n\nconst SOCKET_SERVER_URL = 'http://localhost:8080/chat'; // Adjust port as needed\n\nconst ChatWindow: React.FC = () => {\n    const [uploadedFiles, setUploadedFiles] = useState<File[]>([]);\n    const [socket, setSocket] = useState<Socket | null>(null);\n    const [messages, setMessages] = useState<any[]>([]);\n    const [clientId, setClientId] = useState<string | null>(null);\n\n    // Dynamically retrieve userId and receiverId (replace with actual logic)\n    const [userId] = useState(() => localStorage.getItem('userId') || 'user123'); // Example: from localStorage\n    const [receiverId] = useState(() => localStorage.getItem('receiverId') || 'receiver123'); // Example: from localStorage\n\n    useEffect(() => {\n        const newSocket = io(SOCKET_SERVER_URL, {\n            query: { userId }, // Pass userId to the server\n        });\n        setSocket(newSocket);\n\n        newSocket.on('connect', () => {\n            console.log('Connected to server:', newSocket.id);\n            setClientId(newSocket.id ?? null); // Use null if newSocket.id is undefined\n        });\n\n        // Listen for incoming messages\n        newSocket.on('new_message', (message) => {\n            setMessages((prevMessages) => [...prevMessages, message]);\n        });\n\n        // Listen for user-joined event\n        newSocket.on('user-joined', (username) => {\n            setMessages((prevMessages) => [\n                ...prevMessages,\n                { system: true, text: `${username} has joined the chat.` },\n            ]);\n        });\n\n        // Listen for file-sent event\n        newSocket.on('file-sent', (fileMessage) => {\n            setMessages((prevMessages) => [...prevMessages, fileMessage]);\n        });\n\n        // Handle connection errors\n        newSocket.on('connect_error', (error) => {\n            console.error('Connection error:', error);\n        });\n\n        // Cleanup on unmount\n        return () => {\n            newSocket.close();\n        };\n    }, [userId]);\n\n    const handleFileUpload = (event: React.ChangeEvent<HTMLInputElement>) => {\n        if (event.target.files && event.target.files[0]) {\n            const file = event.target.files[0];\n            setUploadedFiles((prevFiles) => [...prevFiles, file]);\n\n            if (socket) {\n                const formData = new FormData();\n                formData.append('file', file);\n                formData.append('senderId', userId);\n                formData.append('receiverId', receiverId);\n\n                socket.emit('fileUpload', formData, (response: any) => {\n                    if (response.status === 'success') {\n                        console.log('File uploaded successfully:', response.data);\n                    } else {\n                        console.error('File upload failed:', response.message);\n                    }\n                });\n            }\n        }\n    };\n\n    const handleSendMessage = (message: string) => {\n        if (socket) {\n            socket.emit(\n                'send_message',\n                {\n                    senderId: userId,\n                    receiverId,\n                    content: message,\n                },\n                (response: any) => {\n                    if (response.status === 'success') {\n                        console.log('Message sent successfully:', response.data);\n                    } else {\n                        console.error('Message sending failed:', response.message);\n                    }\n                }\n            );\n        }\n    };\n\n    return (\n        <div className=\"chat-container\">\n            <div className=\"chat-header\">\n                <h1>Chat Room</h1>\n                {clientId && <p>Client ID: {clientId}</p>} {/* Display client ID */}\n            </div>\n            <div className=\"chat-content\">\n                <MessageList messages={messages} currentUserId={userId} />\n                <UploadedFiles files={uploadedFiles} />\n                <div className=\"chat-input-area\">\n                    <label htmlFor=\"file-upload\" className=\"file-upload-icon\">\n                        <span>\n                            <FaPaperclip />\n                        </span>\n                    </label>\n                    <input\n                        id=\"file-upload\"\n                        type=\"file\"\n                        style={{ display: 'none' }}\n                        onChange={handleFileUpload}\n                    />\n                    <MessageInput onSend={handleSendMessage} />\n                </div>\n            </div>\n        </div>\n    );\n};\n\nexport default ChatWindow;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}